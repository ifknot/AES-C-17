<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AES-CPP17: crypto::nonce&lt; M, nonce_size, T &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="happy_key_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AES-CPP17
   &#160;<span id="projectnumber">v0.1.1-beta</span>
   </div>
   <div id="projectbrief">Header only, iterator driven, in-place block cipher software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structcrypto_1_1nonce.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="structcrypto_1_1nonce-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">crypto::nonce&lt; M, nonce_size, T &gt; Struct Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate large stateless <em>cryptographically secure</em> random nonces from 32 bit entropy hardware. RDSEED, whilst similar to RDRAND, provides higher level access to the entropy hardware. The RDSEED generator and processor instruction rdseed are available with Intel Broadwell CPUs (and later) and AMD Zen CPUs (and later).  
 <a href="structcrypto_1_1nonce.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="nonce__factory_8h_source.html">nonce_factory.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a429bced594b4ea1744ed33bdfb0b2572"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto_1_1nonce.html#a429bced594b4ea1744ed33bdfb0b2572">value_type</a> = T</td></tr>
<tr class="separator:a429bced594b4ea1744ed33bdfb0b2572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59830758568b35645244232040585bf2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto_1_1nonce.html#a59830758568b35645244232040585bf2">block_t</a> = std::array&lt; T, crypto::BLOCK_SIZE &gt;</td></tr>
<tr class="separator:a59830758568b35645244232040585bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f01632a4376e40b85f36a9568cb8e5"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto_1_1nonce.html#a30f01632a4376e40b85f36a9568cb8e5">seed_t</a> = unsigned int</td></tr>
<tr class="separator:a30f01632a4376e40b85f36a9568cb8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a135c04ce079b592c827585ffeb689efc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto_1_1nonce.html#a59830758568b35645244232040585bf2">block_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto_1_1nonce.html#a135c04ce079b592c827585ffeb689efc">operator()</a> ()</td></tr>
<tr class="memdesc:a135c04ce079b592c827585ffeb689efc"><td class="mdescLeft">&#160;</td><td class="mdescRight">secure nonce generator  <a href="#a135c04ce079b592c827585ffeb689efc">More...</a><br /></td></tr>
<tr class="separator:a135c04ce079b592c827585ffeb689efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;nonce_mode_t M = CSSEED32, size_t nonce_size = NONCE_SIZE, typename T = uint8_t&gt;<br />
struct crypto::nonce&lt; M, nonce_size, T &gt;</h3>

<p>Generate large stateless <em>cryptographically secure</em> random nonces from 32 bit entropy hardware. RDSEED, whilst similar to RDRAND, provides higher level access to the entropy hardware. The RDSEED generator and processor instruction rdseed are available with Intel Broadwell CPUs (and later) and AMD Zen CPUs (and later). </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td></td></tr>
    <tr><td class="paramname">T</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>There are a number of problems with writing a nonce factory:<ul>
<li>Only certain later CPUs support hardware entropy as hardware random number generators (HRNG) Intel Ivy Bridge 2012, AMD 2015</li>
<li>There does not appear to be any consistent compile time way of detecting HRNG support making conditional compilation impossible</li>
<li>Different compilers implement the intrinsics to read the HRNG differently and incompletely</li>
<li>The <b>RDSEED</b> constant is used to select compile time HRNG vs PRNG but must be set manually by using <code>can_rdseed</code> first to manually test the target system</li>
<li>A cryptographically secure nonce requires a HRNG</li>
<li>A cryptographically secure nonce must be at least 12 bytes long to effectively mitigate birthday attacks</li>
<li>In the abscence of an HRNG a pseudo-random number generator (PRNG) fallback is provided for testing purposed <em>but it is not secure</em> </li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>I'm not even sure that providing a PRNG fallback for non-HRNG settings is a good idea?! </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a59830758568b35645244232040585bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59830758568b35645244232040585bf2">&#9670;&nbsp;</a></span>block_t</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;nonce_mode_t M = CSSEED32, size_t nonce_size = NONCE_SIZE, typename T = uint8_t&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structcrypto_1_1nonce.html">crypto::nonce</a>&lt; M, nonce_size, T &gt;::<a class="el" href="structcrypto_1_1nonce.html#a59830758568b35645244232040585bf2">block_t</a> =  std::array&lt;T, crypto::BLOCK_SIZE&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a30f01632a4376e40b85f36a9568cb8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f01632a4376e40b85f36a9568cb8e5">&#9670;&nbsp;</a></span>seed_t</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;nonce_mode_t M = CSSEED32, size_t nonce_size = NONCE_SIZE, typename T = uint8_t&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structcrypto_1_1nonce.html">crypto::nonce</a>&lt; M, nonce_size, T &gt;::<a class="el" href="structcrypto_1_1nonce.html#a30f01632a4376e40b85f36a9568cb8e5">seed_t</a> =  unsigned int</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a429bced594b4ea1744ed33bdfb0b2572"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429bced594b4ea1744ed33bdfb0b2572">&#9670;&nbsp;</a></span>value_type</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;nonce_mode_t M = CSSEED32, size_t nonce_size = NONCE_SIZE, typename T = uint8_t&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structcrypto_1_1nonce.html">crypto::nonce</a>&lt; M, nonce_size, T &gt;::<a class="el" href="structcrypto_1_1nonce.html#a429bced594b4ea1744ed33bdfb0b2572">value_type</a> =  T</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a135c04ce079b592c827585ffeb689efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135c04ce079b592c827585ffeb689efc">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;nonce_mode_t M = CSSEED32, size_t nonce_size = NONCE_SIZE, typename T = uint8_t&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto_1_1nonce.html#a59830758568b35645244232040585bf2">block_t</a> <a class="el" href="structcrypto_1_1nonce.html">crypto::nonce</a>&lt; M, nonce_size, T &gt;::operator() </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>secure nonce generator </p>
<dl class="section return"><dt>Returns</dt><dd>a cryptographically secure nonce block with nonce_size high bytes seeded from hardware entropy source </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="nonce__factory_8h_source.html">nonce_factory.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecrypto.html">crypto</a></li><li class="navelem"><a class="el" href="structcrypto_1_1nonce.html">nonce</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
